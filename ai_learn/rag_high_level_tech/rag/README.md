# DeepSeek + Faiss æœ¬åœ°çŸ¥è¯†åº“æ£€ç´¢ç³»ç»Ÿ

ä½¿ç”¨ DeepSeek API + Faiss æ„å»ºçš„æœ¬åœ°çŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- âœ… æ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼ï¼ˆTXT, PDF, DOCXï¼‰
- âœ… DeepSeek Embedding å‘é‡åŒ–
- âœ… Faiss é«˜é€Ÿå‘é‡æ£€ç´¢
- âœ… DeepSeek Chat ç”Ÿæˆç­”æ¡ˆ
- âœ… äº¤äº’å¼é—®ç­”ç•Œé¢

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. é…ç½® API Key

```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ DeepSeek API Key
# DEEPSEEK_API_KEY=your_api_key_here
```

è·å– API Key: https://platform.deepseek.com/

### 3. å‡†å¤‡æ–‡æ¡£

```bash
# åˆ›å»ºæ–‡æ¡£ç›®å½•
mkdir knowledge_base

# å°†ä½ çš„æ–‡æ¡£ï¼ˆtxt, pdf, docxï¼‰æ”¾å…¥ knowledge_base ç›®å½•
```

### 4. è¿è¡Œç³»ç»Ÿ

```bash
python deepseek_faiss_rag.py
```

## ç³»ç»Ÿæ¶æ„

```
æ–‡æ¡£åŠ è½½ â†’ æ–‡æœ¬åˆ†å‰² â†’ Embeddingç”Ÿæˆ â†’ Faissç´¢å¼•æ„å»º
                                        â†“
ç”¨æˆ·æé—® â†’ Embedding â†’ Faissæ£€ç´¢ â†’ ç»„è£…ä¸Šä¸‹æ–‡ â†’ DeepSeekç”Ÿæˆç­”æ¡ˆ
```

## ä½¿ç”¨æµç¨‹

### ç¬¬ä¸€æ¬¡è¿è¡Œï¼ˆæ„å»ºçŸ¥è¯†åº“ï¼‰

```
1. åŠ è½½æ–‡æ¡£
   - è‡ªåŠ¨æ‰«æ knowledge_base ç›®å½•
   - æ”¯æŒ txt, pdf, docx æ ¼å¼

2. åˆ†å‰²æ–‡æœ¬
   - æ¯å— 500 å­—ç¬¦
   - é‡å  50 å­—ç¬¦ï¼ˆä¿æŒä¸Šä¸‹æ–‡è¿è´¯ï¼‰

3. ç”Ÿæˆ Embedding
   - ä½¿ç”¨ DeepSeek API
   - æ‰¹é‡å¤„ç†ï¼ˆ10ä¸ª/æ‰¹æ¬¡ï¼‰

4. æ„å»ºç´¢å¼•
   - ä½¿ç”¨ Faiss IndexFlatL2
   - ä¿å­˜åˆ° faiss_index.bin

5. å¼€å§‹é—®ç­”
   - è¾“å…¥é—®é¢˜
   - ç³»ç»Ÿæ£€ç´¢ç›¸å…³æ–‡æ¡£
   - ç”ŸæˆåŸºäºäº‹å®çš„ç­”æ¡ˆ
```

### åç»­è¿è¡Œï¼ˆåŠ è½½å·²æœ‰ç´¢å¼•ï¼‰

```
ç¨‹åºå¯åŠ¨åé€‰æ‹© 'n'ï¼ˆä¸é‡æ–°æ„å»ºï¼‰
ç›´æ¥åŠ è½½å·²æœ‰ç´¢å¼•ï¼Œå¿«é€Ÿå¼€å§‹é—®ç­”
```

## æ–‡ä»¶è¯´æ˜

```
.
â”œâ”€â”€ deepseek_faiss_rag.py    # ä¸»ç¨‹åº
â”œâ”€â”€ requirements.txt         # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ .env.example            # é…ç½®ç¤ºä¾‹
â”œâ”€â”€ .env                    # ä½ çš„é…ç½®ï¼ˆéœ€è‡ªè¡Œåˆ›å»ºï¼‰
â”œâ”€â”€ knowledge_base/         # æ–‡æ¡£ç›®å½•ï¼ˆéœ€è‡ªè¡Œåˆ›å»ºï¼‰
â”œâ”€â”€ faiss_index.bin         # Faiss ç´¢å¼•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â””â”€â”€ chunks.pkl              # æ–‡æœ¬å—æ•°æ®ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
```

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡ï¼ˆ.envï¼‰

```bash
# å¿…å¡«
DEEPSEEK_API_KEY=your_api_key_here

# å¯é€‰
DEEPSEEK_BASE_URL=https://api.deepseek.com
DEEPSEEK_EMBEDDING_MODEL=deepseek-chat
DEEPSEEK_CHAT_MODEL=deepseek-chat
```

### æ–‡æœ¬åˆ†å‰²å‚æ•°

```python
# åœ¨ deepseek_faiss_rag.py ä¸­ä¿®æ”¹

splitter = TextSplitter(
    chunk_size=500,      # æ¯å—å­—ç¬¦æ•°ï¼ˆè¶Šå¤§ä¸Šä¸‹æ–‡è¶Šå®Œæ•´ï¼Œä½†æ£€ç´¢ç²¾åº¦é™ä½ï¼‰
    chunk_overlap=50     # é‡å å­—ç¬¦æ•°ï¼ˆè¶Šå¤§è¶Šè¿è´¯ï¼Œä½†å†—ä½™è¶Šå¤šï¼‰
)
```

### æ£€ç´¢å‚æ•°

```python
# æŸ¥è¯¢æ—¶çš„æ£€ç´¢æ•°é‡

result = rag.query(question, top_k=3)  # æ£€ç´¢å‰3ä¸ªæœ€ç›¸å…³æ–‡æ¡£
```

## ç¤ºä¾‹å¯¹è¯

```
â“ ä½ çš„é—®é¢˜: ä»€ä¹ˆæ˜¯RAGï¼Ÿ

ğŸ“š æ‰¾åˆ° 3 ä¸ªç›¸å…³æ–‡æ¡£:

  [1] rag.txt (åˆ†æ•°: 0.2345)
      RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æ˜¯ä¸€ç§ç»“åˆäº†æ£€ç´¢å’Œç”Ÿæˆçš„AIæŠ€æœ¯...

  [2] advanced_rag.pdf (åˆ†æ•°: 0.3456)
      RAFTæ˜¯RAGçš„ä¸€ç§é«˜çº§æŠ€æœ¯...

ğŸ’­ æ­£åœ¨ç”Ÿæˆç­”æ¡ˆ...

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“– ç­”æ¡ˆ:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ ¹æ®æ–‡æ¡£ã€æ¥æº: rag.txtã€‘ï¼ŒRAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æ˜¯ä¸€ç§ç»“åˆäº†æ£€ç´¢å’Œç”Ÿæˆçš„AIæŠ€æœ¯ã€‚å®ƒé€šè¿‡ä»å¤–éƒ¨çŸ¥è¯†åº“æ£€ç´¢ç›¸å…³æ–‡æ¡£æ¥å¢å¼ºå¤§è¯­è¨€æ¨¡å‹çš„ç”Ÿæˆèƒ½åŠ›ã€‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•å¤„ç†ä¸­æ–‡æ–‡æ¡£ï¼Ÿ

A: ç³»ç»Ÿå®Œå…¨æ”¯æŒä¸­æ–‡ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

### Q: å¯ä»¥å¤„ç†å¤šå°‘æ–‡æ¡£ï¼Ÿ

A: ç†è®ºä¸Šæ— é™åˆ¶ã€‚Faiss å¯ä»¥å¤„ç†äº¿çº§å‘é‡ï¼Œå®é™…å—é™äºï¼š
- API è°ƒç”¨é€Ÿç‡é™åˆ¶
- ç£ç›˜ç©ºé—´ï¼ˆç´¢å¼•æ–‡ä»¶ï¼‰
- å†…å­˜ï¼ˆè¿è¡Œæ—¶åŠ è½½ï¼‰

### Q: æ£€ç´¢æ•ˆæœä¸å¥½æ€ä¹ˆåŠï¼Ÿ

A: å°è¯•è°ƒæ•´ï¼š
1. `chunk_size`ï¼ˆè¯•è¯• 300-800ï¼‰
2. `top_k`ï¼ˆè¯•è¯•æ£€ç´¢æ›´å¤šæ–‡æ¡£ï¼‰
3. æ·»åŠ æ›´å¤šç›¸å…³æ–‡æ¡£

### Q: DeepSeek API æœ‰è°ƒç”¨é™åˆ¶å—ï¼Ÿ

A: æ˜¯çš„ï¼Œå»ºè®®ï¼š
- æ‰¹é‡ç”Ÿæˆ embeddingï¼ˆå·²å†…ç½®ï¼‰
- é¿å…é¢‘ç¹é‡å»ºç´¢å¼•
- æŸ¥çœ‹ https://platform.deepseek.com/ äº†è§£é™åˆ¶

### Q: å¦‚ä½•æ›´æ–°çŸ¥è¯†åº“ï¼Ÿ

A:
1. æ·»åŠ æ–°æ–‡æ¡£åˆ° `knowledge_base/`
2. é‡æ–°è¿è¡Œç¨‹åºï¼Œé€‰æ‹© 'y' é‡å»ºç´¢å¼•

## æŠ€æœ¯æ ˆ

- **DeepSeek API**: Embedding + Chat
- **Faiss**: å‘é‡ç›¸ä¼¼åº¦æœç´¢
- **OpenAI SDK**: DeepSeek API å…¼å®¹å±‚
- **Python**: 3.8+

## è¿›é˜¶ä¼˜åŒ–

### 1. ä½¿ç”¨æ›´å¥½çš„ Embedding æ¨¡å‹

```python
# å®‰è£… sentence-transformers
pip install sentence-transformers

# ä¿®æ”¹ DeepSeekEmbedding ç±»
from sentence_transformers import SentenceTransformer

model = SentenceTransformer('paraphrase-multilingual-MiniLM-L12-v2')
embeddings = model.encode(texts)
```

### 2. ä½¿ç”¨æ›´å¿«çš„ Faiss ç´¢å¼•

```python
# ä¿®æ”¹ FaissIndex ç±»
quantizer = faiss.IndexFlatL2(dimension)
index = faiss.IndexIVFFlat(quantizer, dimension, nlist=100)
index.train(embeddings_array)  # éœ€è¦è®­ç»ƒ
index.add(embeddings_array)
```

### 3. æ·»åŠ ç¼“å­˜

```python
# ç¼“å­˜ embedding ç»“æœ
embedding_cache = {}

def get_embedding_cached(text):
    if text not in embedding_cache:
        embedding_cache[text] = get_embedding(text)
    return embedding_cache[text]
```

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è”ç³»æ–¹å¼

- ä½œè€…: Claude Code Assistant
- æ—¥æœŸ: 2026-01-27
